function showPosition(t){var e=t.coords.latitude,l=t.coords.longitude;localStorage.setItem("positionx",e),localStorage.setItem("positiony",l)}function getUrlParam(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),l=window.location.search.substr(1).match(e);return null!==l?unescape(l[2]):null}var transFn=function(t){return $.param(t)},postCfg={headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:transFn},picBasePath="http://47.92.29.81:8891",index=angular.module("index",["ngRoute","mobile-angular-ui","mobile-angular-ui.gestures","ngFileUpload","infinite-scroll"]);index.config(["$routeProvider","$locationProvider",function(t,e){e.html5Mode(!0),t.when("/",{templateUrl:"../html/home.html",controller:"homeCtrl"}).when("/personalCenter",{templateUrl:"../html/personalCenter.html",controller:"personalCenterCtrl"}).when("/editInformation",{templateUrl:"../html/editInformation.html",controller:"editInformationCtrl"}).when("/chooseQrcode",{templateUrl:"../html/chooseQrcode.html",controller:"chooseQrcodeCtrl"}).when("/personalTailor",{templateUrl:"../html/personalTailor.html",controller:"personalTailorCtrl"}).when("/tailorData",{templateUrl:"../html/tailorData.html",controller:"tailorDataCtrl"}).when("/payTailor",{templateUrl:"../html/payTailor.html",controller:"payTailorCtrl"}).when("/compeletPayTailor",{templateUrl:"../html/compeletPayTailor.html",controller:"compeletPayTailorCtrl"}).when("/myTailor",{templateUrl:"../html/myTailor.html",controller:"myTailorCtrl"}).when("/vipCenter",{templateUrl:"../html/vipCenter.html",controller:"vipCenterCtrl"}).when("/fast_login",{templateUrl:"../html/fast_login.html",controller:"fastLoginCtrl"}).when("/works",{templateUrl:"../html/works.html",controller:"worksCtrl"}).when("/workHours",{templateUrl:"../html/workHours.html",controller:"workHoursCtrl"}).when("/morningNight",{templateUrl:"../html/morningNight.html",controller:"morningNightCtrl"}).when("/useMorn/:type/:num",{templateUrl:"../html/useMorn.html",controller:"useMornCtrl"}).when("/monList/:num",{templateUrl:"../html/monList.html",controller:"monListCtrl"}).when("/promList/:num",{templateUrl:"../html/promList.html",controller:"promListCtrl"}).when("/nightList/:num",{templateUrl:"../html/nightList.html",controller:"nightListCtrl"}).when("/noticeList/:num",{templateUrl:"../html/noticeList.html",controller:"noticeListCtrl"}).when("/useNight/:type/:num",{templateUrl:"../html/useNight.html",controller:"useNightCtrl"}).when("/useCard/:num",{templateUrl:"../html/useCard.html",controller:"useCardCtrl"}).when("/joke",{templateUrl:"../html/joke.html",controller:"jokeshowCtrl"}).when("/jokeList/:num",{templateUrl:"../html/jokeList.html",controller:"jokeListCtrl"}).when("/usejoke/:type/:num",{templateUrl:"../html/usejoke.html",controller:"usejokeCtrl"}).when("/holiday",{templateUrl:"../html/holiday.html",controller:"holidayCtrl"}).when("/holidayList/:num",{templateUrl:"../html/holidayList.html",controller:"holidayListCtrl"}).when("/greetList/:num",{templateUrl:"../html/greetList.html",controller:"greetListCtrl"}).when("/useHoliday/:type/:num",{templateUrl:"../html/useHoliday.html",controller:"useHolidayCtrl"}).when("/useGreet/:type/:num",{templateUrl:"../html/useGreet.html",controller:"useGreetCtrl"}).when("/wechatCircle/:type/:num",{templateUrl:"../html/wechatCircle.html",controller:"wechatCircleCtrl"}).when("/promotion",{templateUrl:"../html/promotion.html",controller:"promotionCtrl"}).when("/guest",{templateUrl:"../html/guest.html",controller:"guestCtrl"}).when("/homePage/:uuid",{templateUrl:"../html/homePage.html",controller:"homePageCtrl"}).when("/changeHomePage/:num",{templateUrl:"../html/changeHomePage.html",controller:"changeHomePageCtrl"}).when("/life",{templateUrl:"../html/life.html",controller:"lifeCtrl"}).when("/notice",{templateUrl:"../html/notice.html",controller:"noticeCtrl"}).when("/useNotice/:type/:num",{templateUrl:"../html/useNotice.html",controller:"useNoticeCtrl"}).when("/useActive/:num",{templateUrl:"../html/useActive.html",controller:"useActiveCtrl"}).when("/paySuccess",{templateUrl:"../html/paySuccess.html",controller:"paySuccessCtrl"}).otherwise({redirectTo:"/"})}]),function(){var t=getUrlParam("code");if(t){var e={appid:"wx45618195d7038b9d",secret:"7156c0de543979bbb701006487a4e04a",code:t,grant_type:"authorization_code"};$.ajax({url:"/sns/oauth2/access_token",type:"GET",data:e,async:!1,success:function(t){if(t=JSON.parse(t),t.errcode);else{var e={type:"wx",token:t.access_token,openid:t.openid};$.ajax({url:"/user/unl/thirdlogin.json",type:"GET",data:e,async:!1,success:function(t){1===t.code?(sessionStorage.setItem("login","1"),sessionStorage.setItem("user",JSON.stringify(t.data))):2===t.code?window.location.href="fast_login":0===t.code},error:function(t){}})}},error:function(){alert("授权信息获取失败")}})}var l=navigator.userAgent;if("MicroMessenger"!=l.match(/MicroMessenger/i)){alert("已禁止本次访问：请用微信内置浏览器访问本页面！");var r=window.open("about:blank","_self");r.opener=null,r.close()}}();
index.directive("advertise",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.deferred.promise.then(function(t){e.advertiseSwiper=new Swiper(i.get(0),{direction:"horizontal",speed:300,autoplay:4e3,loop:!0,autoplayDisableOnInteraction:!1,pagination:".swiper-pagination"})})}}}]),index.directive("designer",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.designerDeferred.promise.then(function(t){e.designerSwiper=new Swiper(i.get(0),{direction:"horizontal",effect:"coverflow",grabCursor:!0,centeredSlides:!0,slidesPerView:"auto",coverflow:{rotate:0,stretch:0,depth:100,modifier:1,slideShadows:!0}}),e.designerSwiper.slideTo(1,500,!1)})}}}]),index.directive("activity",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.activityDeferred.promise.then(function(t){e.activitySwiper=new Swiper(i.get(0),{direction:"horizontal",speed:300,autoplay:4e3,loop:!0,autoplayDisableOnInteraction:!1,pagination:".swiper-pagination"})})}}}]),index.directive("flashsale",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.flashSaleDeferred.promise.then(function(t){e.falshSaleSwiper=new Swiper(i.get(0),{direction:"horizontal",slidesPerView:"auto",paginationClickable:!0,freeMode:!0})})}}}]),index.directive("back",["$window",function(e){return{restrict:"A",link:function(i,t,n){t.on("click",function(){e.history.back()})}}}]),index.directive("onFinishRenderFilters",["$timeout",function(e){return{restrict:"A",link:function(i,t,n){i.$last===!0&&e(function(){i.$emit("ngRepeatFinished")})}}}]),index.directive("onDesignerRenderFinished",["$timeout",function(e){return{restrict:"A",link:function(i,t,n){i.$last===!0&&e(function(){i.$emit("designerRepeatFinished")})}}}]),index.directive("onFlashSaleRenderFinished",["$timeout",function(e){return{restrict:"A",link:function(i,t,n){i.$last===!0&&e(function(){i.$emit("flashSaleRepeatFinished")})}}}]),index.directive("onActivityFinished",["$timeout",function(e){return{restrict:"A",link:function(i,t,n){i.$last===!0&&e(function(){i.$emit("activityFinished")})}}}]),index.directive("forbidScroll",["$timeout",function(e){return{restrict:"A",link:function(e,i,t){i.on("touchmove",function(e){e.preventDefault()})}}}]),index.directive("date",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.dateDeferred.promise.then(function(t){e.timeSwiper=new Swiper(i.get(0),{direction:"vertical",speed:300,loop:!1,autoplayDisableOnInteraction:!1,watchSlidesProgress:!0,watchSlidesVisibility:!0,slidesPerView:3,centeredSlides:!0})})}}}]),index.directive("dateOnly",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.dateOnlyDeferred.promise.then(function(t){e.timeOnlySwiper=new Swiper(i.get(0),{direction:"vertical",speed:300,loop:!1,autoplayDisableOnInteraction:!1,watchSlidesProgress:!0,watchSlidesVisibility:!0,slidesPerView:5,centeredSlides:!0})})}}}]),index.directive("time",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.timeSwiper=new Swiper(i.get(0),{direction:"vertical",speed:300,loop:!1,autoplayDisableOnInteraction:!1,watchSlidesProgress:!0,watchSlidesVisibility:!0,slidesPerView:3,centeredSlides:!0})}}}]),index.directive("timeSelect",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.timeSwiper=new Swiper(i.get(0),{direction:"vertical",speed:300,loop:!1,autoplayDisableOnInteraction:!1,watchSlidesProgress:!0,watchSlidesVisibility:!0,slidesPerView:5,centeredSlides:!0})}}}]),index.directive("onTimeFinished",["$timeout",function(e){return{restrict:"A",link:function(i,t,n){i.$last===!0&&e(function(){i.$emit("timeFinished")})}}}]),index.directive("onTimeOnlyFinished",["$timeout",function(e){return{restrict:"A",link:function(i,t,n){i.$last===!0&&e(function(){i.$emit("timeOnlyFinished")})}}}]),index.directive("dateSelect",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.dateDeferred.promise.then(function(t){e.dateSwiper=new Swiper(i.get(0),{direction:"horizontal",slidesPerView:"auto",freeMode:!0})})}}}]),index.directive("onHotSaleFinished",["$timeout",function(e){return{restrict:"A",link:function(i,t,n){i.$last===!0&&e(function(){i.$emit("hotSaleRepeatFinished")})}}}]),index.directive("hotsale",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.hotSaleDeferred.promise.then(function(t){e.hotSaleSwiper=new Swiper(i.get(0),{direction:"horizontal",slidesPerView:"auto",paginationClickable:!0,freeMode:!0,observer:!0,observerParents:!0,onReachEnd:function(i){e.hotSalePage+=1,e.getHotSaleRecommend()}})})}}}]),index.directive("commonSwiper",["$timeout",function(e){return{restrict:"EA",replace:!0,link:function(e,i,t){e.commonSwiper=new Swiper(i.get(0),{observer:!0,observerParents:!0})}}}]);
index.controller("changeHomePageCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,a,s,t,n,o){var i=o.num;e.workTime=[];var r=JSON.parse(sessionStorage.getItem("user")),p=r.uuid;a.post("/user/unl/otherpage.json",{uuid:p},postCfg).then(function(t){if(console.log(t),1===t.data.code){var n=t.data.data;n.avatar=picBasePath+n.avatar,n.qrcode=picBasePath+n.qrcode,n.displaytype=i,e.pointLabel=n.userflags,e.hrefTel="tel:"+n.telephone;for(var o=n.workday,r=0;r<o.length;r++)e.workTime.push(o[r]);for(var d=0;d<n.workslist.length;d++)n.workslist[d]=picBasePath+n.workslist[d];if(e.user=n,console.log(e.user.displaytype),1==e.user.displaytype)return;2==e.user.displaytype?($(".user-info").addClass("user-info2"),$(".line-title-text").addClass("background-333"),$(".line-title-line").addClass("background-333"),$(".call-designer").addClass("background-333"),$(".appointment-btn").addClass("color-333"),$(".dashed-line").addClass("dashed-line-333"),$(".home-page-price").attr("src","../../assets/images/home_page_price1.png"),$(".home-page-time").attr("src","../../assets/images/home_page_time1.png"),$(".home-page-store").attr("src","../../assets/images/home_page_home1.png"),$(".home-page-place").attr("src","../../assets/images/home_page_place1.png")):3==e.user.displaytype&&($(".user-info").addClass("user-info3"),$(".line-title-text").addClass("background-f5a623"),$(".line-title-line").addClass("background-f5a623"),$(".call-designer").addClass("background-f5a623"),$(".appointment-btn").addClass("color-f5a623"),$(".dashed-line").addClass("dashed-line-f5a623"),$(".home-page-price").attr("src","../../assets/images/home_page_price2.png"),$(".home-page-time").attr("src","../../assets/images/home_page_time2.png"),$(".home-page-store").attr("src","../../assets/images/home_page_home2.png"),$(".home-page-place").attr("src","../../assets/images/home_page_place2.png"));var l={url:s.location.href.split("#")[0]};a.post("/user/unl/wzinfo.json",l,postCfg).then(function(a){1===a.data.code&&(wx.config({debug:!1,appId:a.data.data.appid,timestamp:a.data.data.timestamp,nonceStr:a.data.data.noncestr,signature:a.data.data.signature,jsApiList:["checkJsApi","onMenuShareAppMessage","onMenuShareTimeline"]}),wx.ready(function(){wx.onMenuShareAppMessage({title:"最棒的发型师,服务最好的你!",desc:"店名："+e.user.storename+"\n发型师："+e.user.name+"\n服务时间："+e.user.starttime+"-"+e.user.endtime,link:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+p,imgUrl:e.user.avatar,type:"link",dataUrl:"",success:function(){},cancel:function(){}}),wx.onMenuShareTimeline({title:"最棒的发型师,服务最好的你!",desc:"店名："+e.user.storename+"\n发型师："+e.user.name+"\n服务时间："+e.user.starttime+"-"+e.user.endtime,link:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+p,imgUrl:e.user.avatar,success:function(){},cancel:function(){}})}))},function(e){})}},function(e){});var d=new Date;e.nowYear=d.getFullYear(),e.appointment=function(){$(".prompt-fixed").show()},e.promptFalse=function(){$(".prompt-fixed").fadeOut(10)},e.changeHomePage=function(){var n={displaytype:i};a.post("/user/edit.json",n,postCfg).then(function(n){-1===n.data.code?(e.isLogin=!1,t.path("fast_login")):1===n.data.code&&(e.isLogin=!0,a.post("/user/mine.json",postCfg).then(function(a){if(console.log(a),-1===a.data.code)e.isLogin=!1;else if(1===a.data.code){e.isLogin=!0;var t=a.data.data;""===t.avatar?t.avatar="../../assets/images/head-none.png":t.avatar=picBasePath+t.avatar,alert("修改主页风格成功！"),s.history.back()}},function(e){}))},function(e){})}}]);
index.controller("chooseQrcodeCtrl",["$scope","$http","$window","$location","$rootScope",function(a,e,o,t,s){function r(){return 0===a.localId.length?(alert("请选择图片!"),!1):void wx.uploadImage({localId:a.localId[0],isShowProgressTips:1,success:function(o){a.serverId=o.serverId;var t={qrcodemediaid:a.serverId};e.post("/user/edit.json",t,postCfg).then(function(e){if(1===e.data.code){var o=e.data.data;""===o.avatar?o.avatar="../../assets/images/head-none.png":o.avatar=picBasePath+o.avatar,o.qrcode=picBasePath+o.qrcode,a.user=o,sessionStorage.setItem("user",JSON.stringify(c))}else alert(e.data.reason)},function(a){alert("数据请求失败，请稍后再试！")})},fail:function(a){alert("上传失败！")}})}var n={url:o.location.href.split("#")[0]};console.log(n),e.post("/user/unl/wzinfo.json",n,postCfg).then(function(a){1===a.data.code&&(console.log(a),wx.config({debug:!1,appId:a.data.data.appid,timestamp:a.data.data.timestamp,nonceStr:a.data.data.noncestr,signature:a.data.data.signature,jsApiList:["chooseImage","uploadImage"]}))},function(a){});var c=JSON.parse(sessionStorage.getItem("user"));""===c.qrcode?c.qrcode="../../assets/images/edit-headimg.png":c.qrcode=picBasePath+c.qrcode,a.user=c,a.addPhoto=function(){wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){return a.localId=e.localIds,0===a.localId.length?(alert("请选择图片!"),!1):void r()}})},a.upload=function(){o.history.back()}}]);
index.controller("compeletPayTailorCtrl",["$scope","$http","$window","$location","$rootScope",function(e,t,o,r,a){var n=JSON.parse(sessionStorage.getItem("user"));e.user=n,t.post("/user/customizedetail.json",postCfg).then(function(t){1===t.data.code&&(e.customizeOrder=t.data.data.order)},function(e){}),e.toPay=function(){var o={type:"wz",orderid:e.customizeOrder.id};t.post("/pay/prepay.json",o,postCfg).success(function(e){if(1===e.code){var t=e.data;WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:t.timeStamp.toString(),nonceStr:t.nonceStr,"package":t["package"],signType:t.signType,paySign:t.paySign},function(e){"get_brand_wcpay_request:ok"==e.err_msg?(alert("支付成功"),r.path("personalTailor")):alert("支付失败"+e.err_msg)})}else 0===e.code&&alert(e.reason)}).error(function(e){alert(e.reason)})}}]);
index.controller("editInformationCtrl",["$scope","$http","$window","$location","$rootScope","$timeout",function(e,o,t,a,r,i){function n(){return 0===e.localId.length?(alert("请选择头像图片!"),!1):void wx.uploadImage({localId:e.localId[0],isShowProgressTips:1,success:function(t){e.serverId=t.serverId;var a={avatarmediaid:e.serverId};o.post("/user/edit.json",a,postCfg).then(function(o){if(1===o.data.code){var t=o.data.data;""===t.avatar?t.avatar="../../assets/images/head-none.png":t.avatar=picBasePath+t.avatar,e.user=t,sessionStorage.setItem("user",JSON.stringify(t))}else alert(o.data.reason)},function(e){})},fail:function(e){alert("上传失败！")}})}var l=JSON.parse(sessionStorage.getItem("user"));e.user=l,e.name=l.name,e.worktime=l.worktime,null===l.worklevel?e.worklevel="":e.worklevel=l.worklevel.name,e.storename=l.storename,e.storeplace=l.storeplace,e.cutprice=l.cutprice,e.colorpricelow=l.colorpricelow,e.colorpricehigh=l.colorpricehigh,e.permpricelow=l.permpricelow,e.permpricehigh=l.permpricehigh,e.pointLabel=l.flags,e.flagid=[],""!==l.avatar&&"../../assets/images/head-none.png"!==l.avatar||(e.user.avatar="../../assets/images/edit-headimg.png"),""===l.qrcode?e.qrState="(未上传)":e.qrState="(已上传)",o.post("/user/unl/worklevel.json",postCfg).then(function(o){if(1===o.data.code){for(var t=o.data.data.worklevel,a=0;a<t.length;a++)t[a].selected=!1;e.levelList=t}},function(e){}),e.selectLabel=function(e){e.ischoose=!e.ischoose},e.promptFalse=function(){$(".prompt-fixed").fadeOut(),i(function(){t.history.back()})},e.promptTrue=function(){$(".prompt-fixed").fadeOut(10)},e.saveInformation=function(){function t(e){for(var o=new RegExp("[`%~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]"),t="",a=0;a<e.length;a++)t+=e.substr(a,1).replace(o,"");return t}e.flagid=[];for(var r=0;r<e.pointLabel.length;r++)e.pointLabel[r].ischoose===!0&&e.flagid.push(e.pointLabel[r].id),console.log(e.flagid);if(""===e.name||""===e.worktime||""===e.worklevelid||""===e.storename||""===e.storeplace||""===e.cutprice||""===e.colorpricelow||""===e.colorpricehigh||""===e.permpricelow||""===e.permpricehigh||0===e.flagid.length)return void $(".prompt-fixed").show();var i=t(e.name);if(e.name!=i)return void alert("姓名不支持特殊符号，请重新输入！");var n={name:e.name,worktime:e.worktime,worklevelid:e.worklevelid,storename:e.storename,storeplace:e.storeplace,cutprice:e.cutprice,colorpricelow:e.colorpricelow,colorpricehigh:e.colorpricehigh,permpricelow:e.permpricelow,permpricehigh:e.permpricehigh,flagid:e.flagid};o.post("/user/edit.json",n,postCfg).then(function(o){console.log(o),-1===o.data.code?(e.isLogin=!1,a.path("fast_login")):1===o.data.code&&(e.isLogin=!0,a.path("/"))},function(e){})},e.chooseQrcode=function(){window.location.href="/yueAssistant/build/html/chooseQrcode"},e.showLevel=function(){$(".fixed-content").show()},e.selectLevel=function(o){for(var t=0;t<e.levelList.length;t++)e.levelList[t].selected=!1;o.selected=!o.selected,e.worklevelid=o.id,e.worklevel=o.name,$(".fixed-content").fadeOut(10)};var c={url:t.location.href.split("#")[0]};o.post("/user/unl/wzinfo.json",c,postCfg).then(function(e){1===e.data.code&&wx.config({debug:!1,appId:e.data.data.appid,timestamp:e.data.data.timestamp,nonceStr:e.data.data.noncestr,signature:e.data.data.signature,jsApiList:["chooseImage","uploadImage"]})},function(e){}),e.localId=[],e.addPhoto=function(){wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(o){return e.localId=o.localIds,0===e.localId.length?(alert("请选择图片!"),!1):(e.user.avatar=e.localId[0],void n())}})}}]);
index.controller("fastLoginCtrl",["$scope","$http","$window","$location","$interval","$timeout",function(e,t,o,n,a,i){function s(){return d.test(e.phone)?r.test(e.code)?1:(e.modalText="验证码输入错误",$(".prompt-container").show().fadeOut(2e3),-1):(e.modalText="手机号码有误！",$(".prompt-container").show().fadeOut(2e3),-1)}var d=/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/,r=/^\d{4}$/;e.sendCodeText="获取验证码",e.modalText="",e.getCode=function(){if(!e.sending){if(!d.test(e.phone))return e.modalText="手机号码有误！",void $(".prompt-container").show().fadeOut(2e3);var o=(new Date).valueOf(),n="_timestamp="+o+"&telephone="+e.phone+"&key=C5F3EB5D7DC2748AED89E90AF00081E6",i=md5(n).toUpperCase();console.log(o),console.log(i);var s={telephone:e.phone,_timestamp:o,sign:i};t.post("/user/unl/sign/sendlogin.json",s,postCfg).then(function(t){if(console.log(t),1===t.data.code){e.sending=!0;var o=60,n=a(function(){o>0?e.sendCodeText="重新发送("+o--+")":(e.sendCodeText="发送验证码",e.sending=!1,a.cancel(n))},1e3)}},function(e){})}},e.confirmLogin=function(){if(-1!==s()){var o={telephone:e.phone,check:e.code,uuid:e.uuid};t.post("/user/unl/bindtelephone.json",o,postCfg).then(function(t){if(1===t.data.code){var o=t.data.data;sessionStorage.setItem("user",JSON.stringify(o)),i(function(){window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx45618195d7038b9d&redirect_uri=http://syrapi.yueyishujia.com/yueAssistant/build/html/&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect"})}else 0===t.data.code?(e.modalText=t.data.reason,$(".prompt-container").show().fadeOut(2e3)):(e.modalText=t.data.reason,$(".prompt-container").show().fadeOut(2e3))},function(e){alert(e.data.reason)})}}}]);
index.controller("greetListCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,t,o,r,s,i){var n=i.num;e.imgList=[];for(var a=1;6>a;a++)e.imgList.push("../../assets/images/greet/sample/type"+n+"/img_"+a+".png");e.useMornTemplate=function(e){r.path("useGreet/"+n+"/"+e)}}]);
index.controller("guestCtrl",["$scope","$http","$window","$location","$rootScope",function(e,t,a,i,c){document.title="客照展示";var o=JSON.parse(sessionStorage.getItem("user"));e.user=o,e.activeTab=1,c.activeTab&&(e.activeTab=c.activeTab),e.loading=!1,e.changeTab=function(t){switch(e.activeTab=t,t){case 1:c.activeTab=1;break;case 2:c.activeTab=2}},e.useGuest=function(t){window.location.href="../template/guest/index.html?num="+t+"&uuid="+e.user.uuid}}]);
index.controller("holidayCtrl",["$scope","$http","$window","$location","$rootScope",function(t,a,e,i,o){document.title="节日问候",t.activeTab=1,o.activeTabMorn&&(t.activeTab=o.activeTabMorn),t.changeTab=function(a){switch(t.activeTab=a,a){case 1:o.activeTabMorn=1;break;case 2:o.activeTabMorn=2}},t.useMornTemplate=function(t){i.path("holidayList/"+t)},t.useNightTemplate=function(t){i.path("greetList/"+t)}}]);
index.controller("holidayListCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(i,s,o,a,e,t){var n=t.num;if(i.dragon=n,i.imgList=[],6==n)for(var p=1;7>p;p++)i.imgList.push("../../assets/images/holiday/sample/type"+n+"/img_"+p+".png");else for(var r=1;3>r;r++)i.imgList.push("../../assets/images/holiday/sample/type"+n+"/img_"+r+".png");i.useMornTemplate=function(i){a.path("useHoliday/"+n+"/"+i)}}]);
index.controller("homeCtrl",["$scope","$http","$window","$location","$rootScope",function(e,t,a,i,n){document.title="小悦助手",t.post("/user/mine.json",postCfg).then(function(t){if(console.log(t),-1===t.data.code)e.isLogin=!1;else if(1===t.data.code){e.isLogin=!0;var a=t.data.data;""===a.avatar?a.avatar="../../assets/images/head-none.png":a.avatar=picBasePath+a.avatar,e.user=a,sessionStorage.setItem("user",JSON.stringify(a))}},function(e){}),e.personalCenter=function(){i.path("personalCenter")},e.setIn=function(){},e.vipCenter=function(){i.path("vipCenter")},e.showTemplate=function(t){if(e.user.iscomplete===!1)return void $(".prompt-fixed").show();switch(t){case 1:i.path("morningNight");break;case 2:i.path("guest");break;case 3:i.path("notice");break;case 4:i.path("promotion");break;case 5:i.path("holiday");break;case 6:i.path("joke");break;case 7:i.path("life")}},e.goHomePage=function(){return e.user.iscomplete===!1?void $(".prompt-fixed").show():void(window.location.href="/yueAssistant/build/html/homePage/"+e.user.uuid)},e.promptFalse=function(){$(".prompt-fixed").fadeOut(10)},e.promptTrue=function(){$(".prompt-fixed").fadeOut(),i.path("editInformation")};var s={url:a.location.href.split("#")[0]};t.post("/user/unl/wzinfo.json",s,postCfg).then(function(e){1===e.data.code&&(wx.config({debug:!1,appId:e.data.data.appid,timestamp:e.data.data.timestamp,nonceStr:e.data.data.noncestr,signature:e.data.data.signature,jsApiList:["checkJsApi","onMenuShareAppMessage","onMenuShareTimeline"]}),wx.ready(function(){wx.onMenuShareAppMessage({title:"美图助手",desc:"美图助手",link:"https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx45618195d7038b9d&redirect_uri=http://syrapi.yueyishujia.com/yueAssistant/build/html/&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect",imgUrl:"http://syrapi.yueyishujia.com/yueAssistant/assets/images/logo.png",type:"link",dataUrl:"",success:function(){},cancel:function(){}}),wx.onMenuShareTimeline({title:"美图助手",desc:"美图助手",link:"https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx45618195d7038b9d&redirect_uri=http://syrapi.yueyishujia.com/yueAssistant/build/html/&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect",imgUrl:"http://syrapi.yueyishujia.com/yueAssistant/assets/images/logo.png",success:function(){},cancel:function(){}})}))},function(e){})}]);
index.controller("homePageCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,a,t,s,n,o){document.title="主页形象";var i=o.uuid;e.workTime=[],a.post("/user/unl/otherpage.json",{uuid:i},postCfg).then(function(s){if(console.log(s),1===s.data.code){var n=s.data.data;n.avatar=picBasePath+n.avatar,n.qrcode=picBasePath+n.qrcode,e.pointLabel=n.userflags,e.hrefTel="tel:"+n.telephone;for(var o=n.workday,r=0;r<o.length;r++)e.workTime.push(o[r]);for(var d=0;d<n.workslist.length;d++)n.workslist[d]=picBasePath+n.workslist[d];switch(e.user=n,e.user.displaytype){case 1:break;case 2:$(".user-info").addClass("user-info2"),$(".line-title-text").addClass("background-333"),$(".line-title-line").addClass("background-333"),$(".call-designer").addClass("background-333"),$(".appointment-btn").addClass("color-333"),$(".dashed-line").addClass("dashed-line-333"),$(".home-page-price").attr("src","../../assets/images/home_page_price1.png"),$(".home-page-time").attr("src","../../assets/images/home_page_time1.png"),$(".home-page-store").attr("src","../../assets/images/home_page_home1.png"),$(".home-page-place").attr("src","../../assets/images/home_page_place1.png");break;case 3:$(".user-info").addClass("user-info3"),$(".line-title-text").addClass("background-f5a623"),$(".line-title-line").addClass("background-f5a623"),$(".call-designer").addClass("background-f5a623"),$(".appointment-btn").addClass("color-f5a623"),$(".dashed-line").addClass("dashed-line-f5a623"),$(".home-page-price").attr("src","../../assets/images/home_page_price2.png"),$(".home-page-time").attr("src","../../assets/images/home_page_time2.png"),$(".home-page-store").attr("src","../../assets/images/home_page_home2.png"),$(".home-page-place").attr("src","../../assets/images/home_page_place2.png")}var p={url:t.location.href.split("#")[0]};a.post("/user/unl/wzinfo.json",p,postCfg).then(function(a){1===a.data.code&&(wx.config({debug:!1,appId:a.data.data.appid,timestamp:a.data.data.timestamp,nonceStr:a.data.data.noncestr,signature:a.data.data.signature,jsApiList:["checkJsApi","onMenuShareAppMessage","onMenuShareTimeline"]}),wx.ready(function(){wx.onMenuShareAppMessage({title:"最棒的发型师,服务最好的你!",desc:"店名："+e.user.storename+"\n发型师："+e.user.name+"\n服务时间："+e.user.starttime+"-"+e.user.endtime,link:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+i,imgUrl:e.user.avatar,type:"link",dataUrl:"",success:function(){},cancel:function(){}}),wx.onMenuShareTimeline({title:"最棒的发型师,服务最好的你!",desc:"店名："+e.user.storename+"\n发型师："+e.user.name+"\n服务时间："+e.user.starttime+"-"+e.user.endtime,link:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+i,imgUrl:e.user.avatar,success:function(){},cancel:function(){}})}))},function(e){})}},function(e){});var r=new Date;e.nowYear=r.getFullYear(),e.appointment=function(){$(".prompt-fixed").show()},e.promptFalse=function(){$(".prompt-fixed").fadeOut(10)},e.showQrImg=function(){$(".qrcode-fixed-content").show()},e.hideQrImg=function(){$(".qrcode-fixed-content").fadeOut(50)},e.stopPro=function(e){e.stopPropagation()}}]);
index.controller("jokeshowCtrl",["$scope","$http","$window","$location","$rootScope",function(o,t,e,n,c){document.title="段子笑话",o.useTemplate=function(o){n.path("jokeList/"+o)}}]);
index.controller("jokeListCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,o,t,s,i,n){var a=n.num;e.imgList=[];for(var p=1;11>p;p++)e.imgList.push("../../assets/images/joke/sample/type"+a+"/img_"+p+".png");e.type=a,e.useMornTemplate=function(e){s.path("usejoke/"+a+"/"+e)}}]);
index.controller("lifeCtrl",["$scope","$http","$window","$location","$rootScope",function(e,a,i,t,c){document.title="生活日常";var o=JSON.parse(sessionStorage.getItem("user"));e.user=o,e.activeTab=1,c.activeTablife&&(e.activeTab=c.activeTablife),e.changeTab=function(a){switch(e.activeTab=a,a){case 1:c.activeTablife=1;break;case 2:c.activeTablife=2;break;case 3:c.activeTablife=3}},e.useMornTemplate=function(a){window.location.href="../template/life/index.html?num="+a+"&uuid="+e.user.uuid}}]);
index.controller("monListCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,o,t,s,n,r){var i=r.num,a=JSON.parse(sessionStorage.getItem("user"));e.user=a,e.imgList=[];for(var m=1;6>m;m++)e.imgList.push("../../assets/images/morning/type"+i+"/img_"+m+".png");e.useMornTemplate=function(e){s.path("useMorn/"+i+"/"+e)}}]);
index.controller("morningNightCtrl",["$scope","$http","$window","$location","$rootScope",function(t,a,e,n,i){document.title="早晚安",t.activeTab=1,i.activeTabMorn&&(t.activeTab=i.activeTabMorn),t.changeTab=function(a){switch(t.activeTab=a,a){case 1:i.activeTabMorn=1;break;case 2:i.activeTabMorn=2}},t.useMornTemplate=function(t){n.path("monList/"+t)},t.useNightTemplate=function(t){n.path("nightList/"+t)}}]);
index.controller("myTailorCtrl",["$scope","$http","$window","$location","$rootScope",function(o,s,e,t,r){var a=JSON.parse(sessionStorage.getItem("user"));o.user=a,s.post("/user/customizedetail.json",postCfg).then(function(s){if(console.log(s),1===s.data.code){var e=s.data.data.customize;if(o.customizeInfo=e,o.progressFlag=o.customizeInfo.status,o.progressTitle="",o.progressFlag)switch(o.progressFlag){case 1:o.progressTitle="您的预约已经提交";break;case 2:o.progressTitle="已匹配专属编辑";break;case 3:o.progressTitle="编辑正在量身定制";break;case 4:o.progressTitle="您的专属定制已经完成"}}},function(o){}),o.activeTab=1,s.post("/user/customizelist.json",postCfg).then(function(s){if(console.log(s),1===s.data.code){var e=s.data.data.customizelist;for(i=0;i<e.length;i++)e[i].imgurl=picBasePath+e[i].imgurl;o.customizeList=e}},function(o){}),o.showCustomize=function(o){window.location.href=o.jumpurl}}]);
index.controller("nightListCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(t,o,i,n,e,s){var r=s.num;t.imgList=[];for(var a=1;6>a;a++)t.imgList.push("../../assets/images/goodnight/type"+r+"/img_"+a+".png");t.useMornTemplate=function(t){n.path("useNight/"+r+"/"+t)}}]);
index.controller("noticeCtrl",["$scope","$http","$window","$location","$rootScope",function(t,e,a,c,i){document.title="通知海报",t.activeTab=1,i.activeTabMorn&&(t.activeTab=i.activeTabMorn),t.changeTab=function(e){switch(t.activeTab=e,e){case 1:i.activeTabMorn=1;break;case 2:i.activeTabMorn=2}},t.useMornTemplate=function(t){c.path("noticeList/"+t)},t.useNightTemplate=function(t){c.path("useActive/"+t)}}]);
index.controller("noticeListCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(t,o,e,i,n,s){var a=s.num;t.imgList=[];for(var r=1;3>r;r++)t.imgList.push("../../assets/images/notice/sample/type"+a+"/img_"+r+".png");t.useMornTemplate=function(t){i.path("useNotice/"+a+"/"+t)}}]);
index.controller("paySuccessCtrl",["$scope","$http","$window","$location","$rootScope","$timeout",function(o,t,c,n,e,i){i(function(){n.path("/")},1e3)}]);
index.controller("payTailorCtrl",["$scope","$http","$window","$location","$rootScope",function(e,t,r,o,a){e.customizeOrder=a.customizeOrder;var n=JSON.parse(sessionStorage.getItem("user"));e.user=n,e.toPay=function(){var r={type:"wz",orderid:e.customizeOrder.id};t.post("/pay/prepay.json",r,postCfg).success(function(e){if(1===e.code){var t=e.data;WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.appId,timeStamp:t.timeStamp.toString(),nonceStr:t.nonceStr,"package":t["package"],signType:t.signType,paySign:t.paySign},function(e){"get_brand_wcpay_request:ok"==e.err_msg?window.location.href="/yueAssistant/build/html/paySuccess":alert("支付失败，请稍后再试！")})}else 0===e.code&&alert(e.reason)}).error(function(e){alert(e.reason)})}}]);
index.controller("personalCenterCtrl",["$scope","$http","$window","$location","$rootScope",function(o,t,n,a,i){t.post("/user/mine.json",postCfg).then(function(t){if(console.log(t),-1===t.data.code)o.isLogin=!1;else if(1===t.data.code){o.isLogin=!0;var n=t.data.data;""===n.avatar?n.avatar="../../assets/images/head-none.png":n.avatar=picBasePath+n.avatar,o.user=n,sessionStorage.setItem("user",JSON.stringify(n))}},function(o){}),o.editInformation=function(){window.location.href="/yueAssistant/build/html/editInformation"},o.personalTailor=function(){a.path("personalTailor")},o.goVipCenter=function(){a.path("vipCenter")},o.goWorks=function(){window.location.href="/yueAssistant/build/html/works"},o.goWorkHours=function(){a.path("workHours")}}]);
index.controller("personalTailorCtrl",["$scope","$http","$window","$location","$rootScope",function(o,t,a,i,n){t.post("/user/customizepage.json",postCfg).then(function(t){console.log(t),1===t.data.code&&(t.data.data.customizeimgurl=picBasePath+t.data.data.customizeimgurl,o.customizeInfo=t.data.data)},function(o){}),o.tailorData=function(){window.location.href="tailorData"},o.toMyTailor=function(){i.path("myTailor")},o.showCustomize=function(){window.location.href=o.customizeInfo.customizeurl},o.promptFalse=function(){$(".prompt-fixed").fadeOut(10)},o.promptTrue=function(){$(".prompt-fixed").fadeOut(),i.path("compeletPayTailor")}}]);
index.controller("promListCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(o,t,i,e,r,n){var s=n.num;o.imgList=[];for(var a=1;4>a;a++)o.imgList.push("../../assets/images/promotion/type"+s+"/img_"+a+".png");o.useMornTemplate=function(o){e.path("wechatCircle/"+s+"/"+o)}}]);
index.controller("promotionCtrl",["$scope","$http","$window","$location","$rootScope",function(a,e,t,c,i){document.title="个人推广";var o=JSON.parse(sessionStorage.getItem("user"));a.user=o,a.activeTab=2,i.activeTab&&(a.activeTab=i.activeTab),a.loading=!1,a.changeTab=function(e){switch(a.activeTab=e,e){case 1:i.activeTab=1;break;case 2:i.activeTab=2;break;case 3:i.activeTab=3}},a.changeHomePage=function(a){i.activeTab=1,c.path("changeHomePage/"+a)},a.useTemplate=function(a){i.activeTab=3,c.path("promList/"+a)},a.useCard=function(e){i.activeTab=2,window.location.href="../template/card/index.html?num="+e+"&uuid="+a.user.uuid}}]);
index.controller("tailorDataCtrl",["$scope","$http","$window","$location","$rootScope",function(e,i,o,a,d){function t(){wx.uploadImage({localId:e.lifelocalid[e.upImg],isShowProgressTips:1,success:function(i){e.lifeList.push(e.lifelocalid[e.upImg]),$(".update-img-life").prepend("<img src="+e.lifelocalid[e.upImg]+" style='width:1.76rem;height:1.76rem;margin-right:0.266667rem;border-radius:0.066667rem;' />"),e.lifemediaid.push(i.serverId),e.upImg<e.lifelocalid.length&&(e.upImg+=1,t())},fail:function(e){}})}function r(){wx.uploadImage({localId:e.worklocalid[e.upImg],isShowProgressTips:1,success:function(i){e.workList.push(e.worklocalid[e.upImg]),$(".update-img-work").prepend("<img src="+e.worklocalid[e.upImg]+" style='width:1.76rem;height:1.76rem;margin-right:0.266667rem;border-radius:0.066667rem;' />"),e.workmediaid.push(i.serverId),e.upImg<e.worklocalid.length&&(e.upImg+=1,r())},fail:function(e){}})}function l(){wx.uploadImage({localId:e.artlocalid[e.upImg],isShowProgressTips:1,success:function(i){e.artList.push(e.artlocalid[e.upImg]),$(".update-img-art").prepend("<img src="+e.artlocalid[e.upImg]+" style='width:1.76rem;height:1.76rem;margin-right:0.266667rem;border-radius:0.066667rem;' />"),e.artmediaid.push(i.serverId),e.upImg<e.artlocalid.length&&(e.upImg+=1,l())},fail:function(e){}})}function s(){wx.uploadImage({localId:e.goodslocalid[e.upImg],isShowProgressTips:1,success:function(i){e.goodsList.push(e.goodslocalid[e.upImg]),$(".update-img-goods").prepend("<img src="+e.goodslocalid[e.upImg]+" style='width:1.76rem;height:1.76rem;margin-right:0.266667rem;border-radius:0.066667rem;' />"),e.goodsmediaid.push(i.serverId),e.upImg<e.goodslocalid.length&&(e.upImg+=1,s())},fail:function(e){}})}var n={url:o.location.href.split("#")[0]};i.post("/user/unl/wzinfo.json",n,postCfg).then(function(e){1===e.data.code&&wx.config({debug:!1,appId:e.data.data.appid,timestamp:e.data.data.timestamp,nonceStr:e.data.data.noncestr,signature:e.data.data.signature,jsApiList:["chooseImage","uploadImage"]})},function(e){}),e.lifemediaid=[],e.workmediaid=[],e.artmediaid=[],e.goodsmediaid=[],e.lifeList=[],e.workList=[],e.artList=[],e.goodsList=[],e.upImg=0,e.addLifePhoto=function(){return e.lifemediaid.length>=3?(alert("最多可上传3张图片!"),!1):void wx.chooseImage({count:3,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(i){return e.lifelocalid=i.localIds,0===e.lifelocalid.length?(alert("请选择图片!"),!1):(e.upImg=0,void t())}})},e.addWorkPhoto=function(){return e.workmediaid.length>=3?(alert("最多可上传3张图片!"),!1):void wx.chooseImage({count:3,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(i){return e.worklocalid=i.localIds,0===e.worklocalid.length?(alert("请选择图片!"),!1):(e.upImg=0,void r())}})},e.addArtPhoto=function(){return e.artmediaid.length>=3?(alert("最多可上传3张图片!"),!1):void wx.chooseImage({count:3,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(i){return e.artlocalid=i.localIds,0===e.artlocalid.length?(alert("请选择图片!"),!1):(e.upImg=0,void l())}})},e.addGoodsPhoto=function(){return e.goodsmediaid.length>=3?(alert("最多可上传3张图片!"),!1):void wx.chooseImage({count:3,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(i){return e.goodslocalid=i.localIds,0===e.goodslocalid.length?(alert("请选择图片!"),!1):(e.upImg=0,void s())}})},e.toPayTailor=function(){if(""===e.name||""===e.telephone||""===e.education||""===e.work||""===e.activity||""===e.magazine||""===e.stars||""===e.brand||0===e.lifemediaid.length||0===e.workmediaid.length||0===e.artmediaid.length||0===e.goodsmediaid.length)return alert("有信息尚未填写，请完善后再保存"),!1;var o={name:e.name,telephone:e.telephone,education:e.education,work:e.work,activity:e.activity,magazine:e.magazine,stars:e.stars,brand:e.brand,remark:e.remark,lifemediaid:e.lifemediaid,workmediaid:e.workmediaid,artmediaid:e.artmediaid,goodsmediaid:e.goodsmediaid};i.post("/user/addcustomize.json",o,postCfg).then(function(e){1===e.data.code&&(console.log(e),d.customizeOrder=e.data.data,a.path("payTailor"))},function(e){})}}]);
index.controller("useActiveCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,t,a,o,l,n){function i(){e.btnText="一键生成海报",e.showcanvas=!0;var t=new Date,a=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate(),o=t.getMonth()+1;switch(o){case 1:o="JAN";break;case 2:o="FEB";break;case 3:o="MAR";break;case 4:o="APR";break;case 5:o="MAY";break;case 6:o="JUN";break;case 7:o="JUL";break;case 8:o="AUG";break;case 9:o="SEP";break;case 10:o="OCT";break;case 11:o="NOV";break;case 12:o="DEC"}var l=t.getDay();switch(l){case 0:l="Sunday";break;case 1:l="Monday";break;case 2:l="Tuesday";break;case 3:l="Wednesday";break;case 4:l="Thursday";break;case 5:l="Friday";break;case 6:l="Saturday"}var n=new Image;n.src=e.showImg,n.onload=function(){if(x.drawImage(n,0,0,2*d,2*m),1==h){x.drawImage(p,.048*d*2,1142/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+.08*d*2+"px myFirstFont",x.fillStyle="#fff",x.textAlign="left";var o=Math.floor(.212*s*2),l=Math.floor(.5767*s*2),i=Math.floor(.5*s*2),r=Math.floor(.394*m*2),f=Math.floor(.3284*m*2);x.fillText(e.startTime,o,r),x.fillText(e.endTime,l,r),x.fillStyle="#000",x.textAlign="center",x.fillText(e.name,i,f)}else if(2==h){x.drawImage(p,.408*d*2,1152/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+34/750*d*2+"px myFirstFont",x.fillStyle="#fff",x.textAlign="center";var u=Math.floor(.5*s*2),c=(Math.floor(.5667*s*2),Math.floor(.2267*s*2)),M=Math.floor(.3017*s*2),g=Math.floor(.3767*s*2),T=Math.floor(.6296*s*2),y=Math.floor(.6996*s*2),w=Math.floor(.7696*s*2),b=Math.floor(.1147*m*2),$=Math.floor(.3082*m*2),v=Math.floor(.737*m*2);x.fillText(a,u,b),x.font="normal bold "+.064*d*2+"px myFirstFont",x.fillStyle="#000",x.fillText(e.name,u,$),x.fillText(e.startHour,c,v),x.fillText(e.startMinute,g,v),x.fillText(e.endHour,T,v),x.fillText(e.endMinute,w,v),x.fillStyle="#fff",x.fillText(":",M,v),x.fillText(":",y,v)}else if(3==h){x.drawImage(p,.408*d*2,1114/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+.064*d*2+"px myFirstFont",x.fillStyle="#000",x.textAlign="center";var F=(Math.floor(.5*s*2),Math.floor(.5667*s*2),Math.floor(.2267*s*2)),I=Math.floor(.3017*s*2),S=Math.floor(.3767*s*2),k=Math.floor(.6296*s*2),A=Math.floor(.6996*s*2),P=Math.floor(.7696*s*2),D=(Math.floor(.1147*m*2),Math.floor(.3082*m*2),Math.floor(.802*m*2));x.fillText(e.startHour,F,D),x.fillText(e.startMinute,S,D),x.fillText(e.endHour,k,D),x.fillText(e.endMinute,P,D),x.fillText(":",I,D),x.fillText(":",A,D)}else if(4==h){x.drawImage(p,64/750*d*2,1126/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+.048*d*2+"px myFirstFont",x.fillStyle="#fff";var O=Math.floor(.747*s*2),H=Math.floor(.922*m*2);x.fillText(e.name,O,H)}else if(5==h){x.drawImage(p,.408*d*2,1110/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+.096*d*2+"px myFirstFont",x.fillStyle="#244678",x.textAlign="left";var E=Math.floor(.2693*s*2),U=Math.floor(.522*s*2),B=Math.floor(.69*s*2),C=Math.floor(.3355*m*2),J=Math.floor(.4669*m*2),L=Math.floor(.616*m*2),N=Math.floor(.701*m*2);x.fillText(e.startMonth,E,C),x.fillText(e.startDate,U,C),x.fillText(e.endMonth,E,J),x.fillText(e.endDate,U,J),x.textAlign="center",x.fillStyle="#fff",x.fillText(e.colorPrice,B,L),x.fillText(e.permPrice,B,N)}else if(6==h){x.drawImage(p,52/750*d*2,1130/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+.06*d*2+"px myFirstFont",x.fillStyle="#fff",x.textAlign="right";var R=Math.floor(.951*s*2),j=Math.floor(.244*m*2);x.fillText(e.name,R,j)}else if(7==h){x.drawImage(p,.408*d*2,1143/1334*m*2,14/75*d*2,14/75*d*2);var Y=t.getDate()+"/"+(t.getMonth()+1)+"/"+t.getFullYear();x.font="normal bold "+.064*d*2+"px myFirstFont",x.fillStyle="#000",x.textAlign="center";var W=Math.floor(.5*s*2),q=Math.floor(.6587*m*2);x.fillText(Y,W,q)}else if(8==h){x.drawImage(p,.408*d*2,1136/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+.4*d*2+"px myFirstFont",x.fillStyle="#af0008",x.textAlign="center";var G=Math.floor(.5*s*2),V=Math.floor(.7261*m*2);x.fillText(e.day,G,V)}else if(9==h){x.drawImage(p,.408*d*2,1109/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+.064*d*2+"px myFirstFont",x.fillStyle="#000",x.textAlign="center";var _=Math.floor(.51*s*2),z=Math.floor(.509*m*2),K=Math.floor(.589*m*2);x.fillText(e.colorPrice,_,z),x.fillText(e.permPrice,_,K)}else if(10==h){x.drawImage(p,.408*d*2,1148/1334*m*2,14/75*d*2,14/75*d*2),x.font="normal bold "+.064*d*2+"px myFirstFont",x.fillStyle="#000",x.textAlign="center";var Q=Math.floor(.5*s*2),X=Math.floor(.14*s*2),Z=Math.floor(.7364*m*2),ee=Math.floor(.8052*m*2);x.fillText(e.name,Q,Z),x.font="normal bold "+.096*d*2+"px myFirstFont",x.fillStyle="#324ee9",x.textAlign="left",x.fillText(e.startDate,X,ee)}}}function r(){e.showcanvas=!1;var t=document.getElementById("main"),a=t.toDataURL("image/jpeg",.7);e.canvasImg=a,e.btnText="长按保存至手机，再发到朋友圈炫耀"}var f=JSON.parse(sessionStorage.getItem("user"));e.fastuse=!0,e.user=f,e.btnText="一键生成海报",e.loading=!1,e.showcanvas=!0,e.showmodel=!1,e.canvasImg="",e.name="请添加",e.startTime="13:00",e.endTime="18:00",e.startHour="13",e.startMinute="00",e.endHour="18",e.endMinute="00",e.startMonth="05",e.startDate="01",e.endMonth="05",e.endDate="15",e.colorPrice="88",e.permPrice="88",e.day="2";var s=document.documentElement.clientWidth,d=Math.floor(s),m=Math.floor(1.83*s);$("#main").css("width",d+"px"),$("#main").css("height",m+"px"),console.log(e.user);var h=n.num;e.page=1,e.showImg="../../assets/images/notice/type6/img_"+h+".png",e.editInformation=function(e){e.stopPropagation(),o.path("editInformation")},e.useTemplatePage=function(t){t.stopPropagation(),r(),e.showmodel=!0,e.btnText="长按保存至手机，再发到朋友圈炫耀"},e.goBack=function(e){e.stopPropagation(),a.history.back()},e.chengeText=function(){if(e.fastuse=!0,e.name="",e.startTime="",e.endTime="",e.startHour="",e.startMinute="",e.endHour="",e.endMinute="",e.startMonth="",e.startDate="",e.endMonth="",e.endDate="",e.colorPrice="",e.permPrice="",e.day="",!e.showmodel)if(1==h)$(".name-input-fixed").show();else if(2==h)$(".name-input-fixed-1").show();else if(3==h)$(".name-input-fixed-2").show();else if(4==h)$(".name-input-fixed-3").show();else if(5==h)$(".name-input-fixed-4").show();else if(6==h)$(".name-input-fixed-5").show();else{if(7==h)return e.fastuse=!1,void i();8==h?$(".name-input-fixed-7").show():9==h?$(".name-input-fixed-8").show():10==h?$(".name-input-fixed-9").show():11==h&&$(".name-input-fixed-10").show()}},e.updateText=function(){i(),1==h?$(".name-input-fixed").fadeOut(50):2==h?$(".name-input-fixed-1").fadeOut(50):3==h?$(".name-input-fixed-2").fadeOut(50):4==h?$(".name-input-fixed-3").fadeOut(50):5==h?$(".name-input-fixed-4").fadeOut(50):6==h?$(".name-input-fixed-5").fadeOut(50):7==h?$(".name-input-fixed-6").fadeOut(50):8==h?$(".name-input-fixed-7").fadeOut(50):9==h?$(".name-input-fixed-8").fadeOut(50):10==h?$(".name-input-fixed-9").fadeOut(50):11==h&&$(".name-input-fixed-10").fadeOut(50),e.fastuse=!1},e.closeText=function(t){t.stopPropagation(),e.user.iscomplete=!0};var u=document.getElementById("main"),x=u.getContext("2d");u.width=2*d,u.height=2*m,$(function(){i()});var c=$(".hideImg").qrcode({width:200,height:200,correctLevel:0,text:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+e.user.uuid}).hide(),M=c.find("canvas").get(0),g=M.toDataURL("image/jpg"),p=new Image;p.src=g}]);
index.controller("useCardCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,a,t,o,r,n){function l(){e.btnText="生成海报",e.showcanvas=!0;var a=new Date,t=a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate(),o=a.getMonth()+1;switch(o){case 1:o="J A N";break;case 2:o="F E B";break;case 3:o="M A R";break;case 4:o="A P R";break;case 5:o="M A Y";break;case 6:o="J U N";break;case 7:o="J U L";break;case 8:o="A U G";break;case 9:o="S E P";break;case 10:o="O C T";break;case 11:o="N O V";break;case 12:o="D E C"}var r=a.getDay();switch(r){case 0:r="Sunday";break;case 1:r="Monday";break;case 2:r="Tuesday";break;case 3:r="Wednesday";break;case 4:r="Thursday";break;case 5:r="Friday";break;case 6:r="Saturday"}var n=i("main");n.width,n.height;n.clearRect(0,0,1e3,1e3);var l=new Image;l.src=e.updateImg,l.width=c,l.height="auto";var f=new Image;f.src=e.showImg,f.onload=function(){if(1==d){n.drawImage(l,0,0,c,m,e.dragX,e.dragY,c,m),n.drawImage(f,0,0,c,m),n.font="normal bold 0.32rem myFirstFont",n.fillStyle="#545454";var i=Math.floor(.07*h),s=Math.floor(.866*m),g=Math.floor(.897*m),u=Math.floor(.923*m);n.fillText(e.user.name,i,s),n.fillText(o+"."+r,i,g),n.fillText(t,i,u)}else if(2==d){n.drawImage(l,0,0,c,m,e.dragX,e.dragY,e.pinchWidth,e.pinchHeight),n.drawImage(f,0,0,c,m),n.font="normal bold 0.4rem myFirstFont",n.fillStyle="#fff";for(var M=Math.floor(.625*h),b=Math.floor(.826*h),p=Math.floor(.716*m),x=Math.floor(.88*m),y=Math.floor(.92*m),T=0;T<e.user.name.length;T++)n.fillText(e.user.name[T],b,p+Math.floor(.0437*m)*T);n.fillText(o+"."+r,M,x),n.fillText(t,M,y)}else if(3==d){n.font="normal bold 0.42rem myFirstFont",n.fillStyle="white";var v=Math.floor(.066*h),w=Math.floor(.8*h),I=Math.floor(.076*m),k=Math.floor(.105*m),F=Math.floor(.329*m);n.fillText(a.getMonth()+1+"/"+a.getDate(),v,I),n.fillText(r,v,k);for(var S=0;S<e.user.name.length;S++)n.fillText(e.user.name[S],w,F+Math.floor(.0437*m)*S)}else if(4==d){n.font="normal bold 1.333333rem myFirstFont",n.fillStyle="white";var $=Math.floor(.103*h),D=Math.floor(.8*h),Y=Math.floor(.87*m),A=Math.floor(.91*m),E=Math.floor(.947*m),R=Math.floor(.329*m);n.fillText(a.getDate(),$,Y),n.font="normal bold 0.4rem myFirstFont",n.fillText(o+"."+r,$,A),n.fillText(a.getFullYear(),$,E);for(var W=0;W<e.user.name.length;W++)n.fillText(e.user.name[W],D,R+Math.floor(.0437*m)*W)}else if(5==d){n.drawImage(l,0,0,c,m,e.dragX,e.dragY,e.pinchWidth,e.pinchHeight),n.drawImage(f,0,0,c,m),n.font="normal bold 0.453333rem myFirstFont",n.fillStyle="#545454";var C=Math.floor(.103*h),U=Math.floor(.8*h),X=Math.floor(.9*m),B=Math.floor(.94*m),H=Math.floor(.329*m);n.fillText(o+"."+r,C,X),n.fillText(t,C,B),n.fillStyle="#fff";for(var J=0;J<e.user.name.length;J++)n.fillText(e.user.name[J],U,H+Math.floor(.0437*m)*J)}}}function i(e){return document.getElementById(e).getContext("2d")}function f(){e.showcanvas=!1;var a=document.getElementById("main"),t=a.toDataURL("image/jpeg",.7);e.canvasImg=t,$(".changeText").css("display","none"),e.btnText="长按保存至手机，再发到朋友圈炫耀"}var s=JSON.parse(sessionStorage.getItem("user"));e.user=s,e.btnText="生成海报",e.loading=!1,e.showcanvas=!0,e.canvasImg="";var h=document.documentElement.clientWidth,c=Math.floor(h),m=Math.floor(1.83*h);$("#main").attr("width",c+"px"),$("#main").attr("height",m+"px"),e.updateImg="",e.dragX=0,e.dragY=0,e.pinchWidth=1,e.pinchHeight=1,e.user.name.length>=3&&(e.user.name=e.user.name[0]+e.user.name[1]);var d=n.num;e.page=1,e.showImg="../../assets/images/promotion/type4/img_"+d+".png",e.editInformation=function(){o.path("editInformation")},e.useTemplatePage=function(){f(),e.btnText="长按保存至手机，再发到朋友圈炫耀"},e.goBack=function(){t.history.back()},e.closeText=function(){e.user.iscomplete=!0},$(".upload").on("change",function(){var a=$(this)[0].files[0];if(a){var t=new FileReader;t.readAsDataURL(a),t.onload=function(){var a=this.result;e.updateImg=a,l()}}}),touch.on("#main","dragend",function(a){e.dragX=a.x,e.dragY=a.y,l()}),touch.on("#main","pinchend",function(a){e.pinchWidth=a.scale,e.pinchHeight=a.scale,l()}),$(function(){l()})}]);
index.controller("useHolidayCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,t,a,n,o,i){function m(){e.btnText="一键生成海报",e.showcanvas=!0;var t=new Image;t.src=e.showImg,t.onload=function(){if(p.drawImage(t,0,0,2*c,2*d),1==l&&2==h){p.font="normal bold "+40/750*c*2+"px myFirstFont",p.fillStyle="#fff";var a=Math.floor(.153*g*2),n=Math.floor(.335*d*2);p.fillText(e.name+"祝您",a,n)}else 3==l&&1==h?p.drawImage(x,.764*c*2,1137/1334*d*2,14/75*c*2,14/75*c*2):3==l&&2==h?p.drawImage(x,44/750*c*2,1134/1334*d*2,14/75*c*2,14/75*c*2):5==l&&1==h?p.drawImage(x,.048*c*2,1138/1334*d*2,14/75*c*2,14/75*c*2):5==l&&2==h&&p.drawImage(x,.048*c*2,1122/1334*d*2,14/75*c*2,14/75*c*2)}}function s(){e.showcanvas=!1;var t=document.getElementById("main"),a=t.toDataURL("image/jpeg",.7);e.canvasImg=a,e.btnText="长按保存至手机，再发到朋友圈炫耀"}var r=JSON.parse(sessionStorage.getItem("user"));e.user=r,e.btnText="一键生成海报",e.loading=!1,e.showcanvas=!0,e.showmodel=!1,e.canvasImg="",e.name="请添加";var g=document.documentElement.clientWidth,c=Math.floor(g),d=Math.floor(1.83*g);$("#main").css("width",c+"px"),$("#main").css("height",d+"px"),console.log(e.user),e.name.length>=4&&(e.name=e.name[0]+e.name[1]+e.name[2]);var l=i.type,h=i.num;e.page=1,e.showImg="../../assets/images/holiday/type"+l+"/img_"+h+".png",e.editInformation=function(e){e.stopPropagation(),n.path("editInformation")},e.useTemplatePage=function(t){t.stopPropagation(),s(),e.showmodel=!0,e.btnText="长按保存至手机，再发到朋友圈炫耀"},e.goBack=function(e){e.stopPropagation(),a.history.back()},e.chengeText=function(){e.showmodel||1==l&&2==h&&$(".name-input-fixed").show()},e.updateText=function(){e.name.length>=4&&(e.name=e.name[0]+e.name[1]+e.name[2]),m(),$(".name-input-fixed").fadeOut(50)},e.closeText=function(t){t.stopPropagation(),e.user.iscomplete=!0};var u=document.getElementById("main"),p=u.getContext("2d");u.width=2*c,u.height=2*d,$(function(){m()});var f=$(".hideImg").qrcode({width:200,height:200,correctLevel:0,text:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+e.user.uuid}).hide(),w=f.find("canvas").get(0),I=w.toDataURL("image/jpg"),x=new Image;x.src=I}]);
index.controller("usejokeCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,t,a,n,o,i){function m(){e.btnText="一键生成海报",e.showcanvas=!0;var t=new Image;t.src=e.showImg,t.onload=function(){l.drawImage(t,0,0,2*c,2*d),1==u?l.drawImage(v,.408*c*2,1146/1334*d*2,14/75*c*2,14/75*c*2):2==u?l.drawImage(v,.408*c*2,1128/1334*d*2,14/75*c*2,14/75*c*2):3==u?l.drawImage(v,577/750*c*2,1137/1334*d*2,14/75*c*2,14/75*c*2):4==u?l.drawImage(v,.756*c*2,1130/1334*d*2,14/75*c*2,14/75*c*2):5==u&&l.drawImage(v,.408*c*2,1086/1334*d*2,14/75*c*2,14/75*c*2)}}function s(){e.showcanvas=!1;var t=document.getElementById("main"),a=t.toDataURL("image/jpeg",.7);e.canvasImg=a,e.btnText="长按保存至手机，再发到朋友圈炫耀"}var g=JSON.parse(sessionStorage.getItem("user"));e.user=g,e.btnText="一键生成海报",e.loading=!1,e.showcanvas=!0,e.showmodel=!1,e.canvasImg="",e.name="请添加";var r=document.documentElement.clientWidth,c=Math.floor(r),d=Math.floor(1.83*r);$("#main").css("width",c+"px"),$("#main").css("height",d+"px"),console.log(e.user),e.name.length>=4&&(e.name=e.name[0]+e.name[1]+e.name[2]);var u=i.type,h=i.num;e.page=1,e.showImg="../../assets/images/joke/type"+u+"/img_"+h+".png",e.editInformation=function(e){e.stopPropagation(),n.path("editInformation")},e.useTemplatePage=function(t){t.stopPropagation(),s(),e.showmodel=!0,e.btnText="长按保存至手机，再发到朋友圈炫耀"},e.goBack=function(e){e.stopPropagation(),a.history.back()},e.chengeText=function(){e.showmodel||1==u&&2==h&&$(".name-input-fixed").show()},e.updateText=function(){e.name.length>=4&&(e.name=e.name[0]+e.name[1]+e.name[2]),m(),$(".name-input-fixed").fadeOut(50)},e.closeText=function(t){t.stopPropagation(),e.user.iscomplete=!0};var p=document.getElementById("main"),l=p.getContext("2d");p.width=2*c,p.height=2*d,$(function(){m()});var w=$(".hideImg").qrcode({width:200,height:200,correctLevel:0,text:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+e.user.uuid}).hide(),f=w.find("canvas").get(0),I=f.toDataURL("image/jpg"),v=new Image;v.src=I}]);
index.controller("useMornCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,t,a,o,l,r){function n(){e.btnText="立即使用",e.showcanvas=!0;var t=new Date,a=t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate(),o=t.getMonth()+1;switch(o){case 1:o="J A N";break;case 2:o="F E B";break;case 3:o="M A R";break;case 4:o="A P R";break;case 5:o="M A Y";break;case 6:o="J U N";break;case 7:o="J U L";break;case 8:o="A U G";break;case 9:o="S E P";break;case 10:o="O C T";break;case 11:o="N O V";break;case 12:o="D E C"}var l=t.getDay();switch(l){case 0:l="S U N D A Y";break;case 1:l="M O N D A Y";break;case 2:l="T U E S D A Y";break;case 3:l="W E D N E S D A Y";break;case 4:l="T H U R S D A Y";break;case 5:l="F R I D A Y";break;case 6:l="S A T U R D A Y"}var r=new Image;r.src=e.showImg,r.onload=function(){if(b.drawImage(r,0,0,Math.floor(2*m),Math.floor(2*c)),1==h){b.font="normal bold "+.048*m*2+"px myFirstFont",b.fillStyle="black",b.textAlign="right";var n=Math.floor(.744*i*2),f=Math.floor(.95*c*2);b.fillText("BY"+e.user.name,n,f)}else if(2==h){b.font="normal bold "+.04*m*2+"px myFirstFont",b.fillStyle="black";var s=Math.floor(.07*i*2),x=Math.floor(.906*c*2),g=Math.floor(.943*c*2);b.fillText("BY"+e.user.name,s,x),b.fillText(a,s,g)}else if(3==h){b.font="normal bold "+100/750*m*2+"px myFirstFont",b.fillStyle="white";var u=Math.floor(.103*i*2),M=Math.floor(.87*c*2),d=Math.floor(.91*c*2),T=Math.floor(.947*c*2);b.fillText(t.getDate(),u,M),b.font="normal bold "+.04*m*2+"px myFirstFont",b.fillText(o+"."+l,u,d),b.fillText("BY"+e.user.name,u,T)}else if(4==h){b.font="normal bold "+34/750*m*2+"px myFirstFont",b.fillStyle="black",b.textAlign="right";var y=Math.floor(.924*i*2),p=Math.floor(.145*c*2),F=Math.floor(.184*c*2),k=Math.floor(.223*c*2);b.fillText(a,y,p),b.fillText(l,y,F),b.fillText("BY"+e.user.name,y,k)}else if(5==h){b.font="normal bold "+34/750*m*2+"px myFirstFont",b.fillStyle="#7a8776",b.textAlign="right";var v=Math.floor(.933*i*2),S=Math.floor(.736*c*2);b.fillText("BY"+e.user.name,v,S)}else if(6==h){b.font="normal bold "+34/750*m*2+"px myFirstFont",b.fillStyle="#fff";var Y=Math.floor(.047*i*2),A=Math.floor(.915*c*2);b.fillText("BY"+e.user.name,Y,A)}else if(7==h){b.font="normal bold "+.04*m*2+"px myFirstFont",b.fillStyle="#000";var w=Math.floor(.07*i*2),D=Math.floor(.856*c*2),B=Math.floor(.883*c*2),I=Math.floor(.91*c*2);b.fillText(a,w,D),b.fillText(l,w,B),b.fillText("BY"+e.user.name,w,I)}else if(8==h){b.font="normal bold "+100/750*m*2+"px myFirstFont",b.fillStyle="#96bfad";var E=Math.floor(.07*i*2),$=Math.floor(.106*c*2),U=Math.floor(.146*c*2),N=Math.floor(.186*c*2);b.fillText(t.getDate(),E,$),b.font="normal bold "+.04*m*2+"px myFirstFont",b.fillText(l,E,U),b.fillText("BY"+e.user.name,E,N)}}}function f(){e.showcanvas=!1;var t=document.getElementById("main"),a=t.toDataURL("image/jpeg",.7);e.canvasImg=a,e.btnText="长按保存至手机，再发到朋友圈炫耀"}var s=JSON.parse(sessionStorage.getItem("user"));e.user=s,e.btnText="立即使用",e.loading=!1,e.showcanvas=!0,e.canvasImg="";var i=document.documentElement.clientWidth,m=Math.floor(i),c=Math.floor(i*(1334/750));$("#main").css("width",m+"px"),$("#main").css("height",c+"px"),console.log(e.user),e.user.name.length>=4&&(e.user.name=e.user.name[0]+e.user.name[1]+e.user.name[2]+e.user.name[3]);var h=r.type,x=r.num;e.showImg="../../assets/images/morning/type"+h+"/img_"+x+".png",e.editInformation=function(){o.path("editInformation")},e.useTemplatePage=function(){f(),e.btnText="长按保存至手机，再发到朋友圈炫耀"},e.goBack=function(){a.history.back()},e.closeText=function(){e.user.iscomplete=!0};var g=document.getElementById("main"),b=g.getContext("2d");g.width=2*m,g.height=2*c,$(function(){n()})}]);
index.controller("useNightCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(t,e,o,l,a,r){function f(){t.btnText="立即使用",t.showcanvas=!0;var e=new Date,o=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate(),l=e.getMonth()+1;switch(l){case 1:l="J A N";break;case 2:l="F E B";break;case 3:l="M A R";break;case 4:l="A P R";break;case 5:l="M A Y";break;case 6:l="J U N";break;case 7:l="J U L";break;case 8:l="A U G";break;case 9:l="S E P";break;case 10:l="O C T";break;case 11:l="N O V";break;case 12:l="D E C"}var a=e.getDay();switch(a){case 0:a="Sunday";break;case 1:a="Monday";break;case 2:a="Tuesday";break;case 3:a="Wednesday";break;case 4:a="Thursday";break;case 5:a="Friday";break;case 6:a="Saturday"}var r=new Image;r.src=t.showImg,r.onload=function(){if(g.drawImage(r,0,0,2*h,2*m),1==c){g.font="normal bold "+.032*h*2+"px myFirstFont",g.fillStyle="#545454";var f=Math.floor(.07*s*2),n=Math.floor(.866*m*2),i=Math.floor(.897*m*2),M=Math.floor(.923*m*2);g.fillText(t.user.name,f,n),g.fillText(l+"."+a,f,i),g.fillText(o,f,M)}else if(2==c){g.font="normal bold "+.032*h*2+"px myFirstFont",g.fillStyle="#fff";for(var x=Math.floor(.625*s*2),u=Math.floor(.826*s*2),d=Math.floor(.716*m*2),T=Math.floor(.88*m*2),b=Math.floor(.92*m*2),y=0;y<t.user.name.length;y++)g.fillText(t.user.name[y],u,d+Math.floor(.0437*m*2)*y);g.fillText(l+"."+a,x,T),g.fillText(o,x,b)}else if(3==c){g.font="normal bold "+.032*h*2+"px myFirstFont",g.fillStyle="white";var F=Math.floor(.066*s*2),p=Math.floor(.8*s*2),v=Math.floor(.076*m*2),k=Math.floor(.105*m*2),w=Math.floor(.329*m*2);g.fillText(e.getMonth()+1+"/"+e.getDate(),F,v),g.fillText(a,F,k);for(var S=0;S<t.user.name.length;S++)g.fillText(t.user.name[S],p,w+Math.floor(.0437*m*2)*S)}else if(4==c){g.font="normal bold "+100/750*h*2+"px myFirstFont",g.fillStyle="white";var I=Math.floor(.103*s*2),D=Math.floor(.8*s*2),$=Math.floor(.87*m*2),E=Math.floor(.91*m*2),Y=Math.floor(.947*m*2),A=Math.floor(.329*m*2);g.fillText(e.getDate(),I,$),g.font="normal bold "+.032*h*2+"px myFirstFont",g.fillText(l+"."+a,I,E),g.fillText(e.getFullYear(),I,Y);for(var B=0;B<t.user.name.length;B++)g.fillText(t.user.name[B],D,A+Math.floor(.0437*m*2)*B)}else if(5==c){g.font="normal bold "+.032*h*2+"px myFirstFont",g.fillStyle="#545454";var N=Math.floor(.103*s*2),C=Math.floor(.8*s*2),J=Math.floor(.9*m*2),P=Math.floor(.94*m*2),U=Math.floor(.329*m*2);g.fillText(l+"."+a,N,J),g.fillText(o,N,P),g.fillStyle="#fff";for(var O=0;O<t.user.name.length;O++)g.fillText(t.user.name[O],C,U+Math.floor(.0437*m*2)*O)}else if(6==c){g.font="normal bold "+124/750*h*2+"px myFirstFont",g.fillStyle="#fff";var R=Math.floor(.07*s*2),L=Math.floor(.479*s*2),W=Math.floor(.106*m*2),j=Math.floor(.146*m*2),G=Math.floor(.186*m*2),V=Math.floor(.434*m*2);g.fillText(e.getDate(),R,W),g.font="normal bold "+.032*h*2+"px myFirstFont",g.fillText(l+"."+a,R,j),g.fillText(e.getFullYear(),R,G);for(var _=0;_<t.user.name.length;_++)g.fillText(t.user.name[_],L,V+Math.floor(.0437*m*2)*_)}else if(7==c){g.font="normal bold "+.032*h*2+"px myFirstFont",g.fillStyle="#545454";var q=Math.floor(.066*s*2),z=Math.floor(.059*m*2),H=Math.floor(.088*m*2);g.fillText(l+"."+a,q,z),g.fillText(o,q,H)}else if(8==c){g.font="normal bold "+124/750*h*2+"px myFirstFont",g.fillStyle="#1b273";var K=Math.floor(.08*s*2),Q=Math.floor(.146*m*2),X=Math.floor(.186*m*2),Z=Math.floor(.226*m*2),tt=Math.floor(.9078*m*2);g.fillText(e.getDate(),K,Q),g.font="normal bold "+.032*h*2+"px myFirstFont",g.fillText(l+"."+a,K,X),g.fillText(e.getFullYear(),K,Z),g.fillStyle="#535353",g.fillText("BY"+t.user.name,K,tt)}}}function n(){t.showcanvas=!1;var e=document.getElementById("main"),o=e.toDataURL("image/jpeg",.7);t.canvasImg=o,t.btnText="长按保存至手机，再发到朋友圈炫耀"}var i=JSON.parse(sessionStorage.getItem("user"));t.user=i,t.btnText="立即使用",t.loading=!1,t.showcanvas=!0,t.canvasImg="";var s=document.documentElement.clientWidth,h=Math.floor(s),m=Math.floor(1.83*s);$("#main").css("width",h+"px"),$("#main").css("height",m+"px"),console.log(t.user);var c=r.type,M=r.num;t.page=1,t.showImg="../../assets/images/goodnight/type"+c+"/img_"+M+".png",t.editInformation=function(){l.path("editInformation")},t.useTemplatePage=function(){n(),t.btnText="长按保存至手机，再发到朋友圈炫耀"},t.goBack=function(){o.history.back()},t.closeText=function(){t.user.iscomplete=!0};var x=document.getElementById("main"),g=x.getContext("2d");x.width=2*h,x.height=2*m,$(function(){f()})}]);
index.controller("useNoticeCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(t,e,o,a,l,i){function n(){t.btnText="一键生成海报",t.showcanvas=!0;var e=new Date,o=e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate(),a=e.getMonth()+1;switch(a){case 1:a="JAN";break;case 2:a="FEB";break;case 3:a="MAR";break;case 4:a="APR";break;case 5:a="MAY";break;case 6:a="JUN";break;case 7:a="JUL";break;case 8:a="AUG";break;case 9:a="SEP";break;case 10:a="OCT";break;case 11:a="NOV";break;case 12:a="DEC"}var l=e.getDay();switch(l){case 0:l="Sunday";break;case 1:l="Monday";break;case 2:l="Tuesday";break;case 3:l="Wednesday";break;case 4:l="Thursday";break;case 5:l="Friday";break;case 6:l="Saturday"}var i=new Image;i.src=t.showImg,i.onload=function(){if(p.drawImage(i,0,0,2*m,2*d),1==h){p.font="normal bold "+.048*m*2+"px myFirstFont",p.fillStyle="#fff";var e=Math.floor(.1133*s*2),n=Math.floor(.88*d*2),f=Math.floor(.91*d*2),r=Math.floor(.94*d*2);p.fillText(t.name,e,n),p.font="normal bold "+.032*m*2+"px myFirstFont",p.fillText(a+"."+l,e,f),p.fillText(o,e,r)}else if(2==h&&1==x){p.drawImage(b,8/75*m*2,1106/1334*d*2,14/75*m*2,14/75*m*2),p.font="normal bold "+.048*m*2+"px myFirstFont",p.fillStyle="#fff";var u=Math.floor(.5733*s*2),c=Math.floor(.704*s*2),g=Math.floor(.3999*d*2),M=Math.floor(.6372*d*2),y=Math.floor(.6672*d*2),T=Math.floor(.6972*d*2);p.fillText(t.zhekou,u,g),p.fillStyle="#333",p.fillText(t.name,c,M),p.font="normal bold "+.032*m*2+"px myFirstFont",p.fillText(a+"."+l,c,y),p.fillText(o,c,T)}else if(2==h&&2==x){p.drawImage(b,.744*m*2,1120/1334*d*2,14/75*m*2,14/75*m*2),p.font="normal bold "+.04*m*2+"px myFirstFont",p.fillStyle="#333";var F=Math.floor(.3673*s*2),w=Math.floor(.211*s*2),$=Math.floor(.6567*d*2),v=Math.floor(.8685*d*2),I=Math.floor(.8985*d*2),S=Math.floor(.9285*d*2);p.fillText(t.lijian,F,$),p.font="normal bold "+.048*m*2+"px myFirstFont",p.fillStyle="#fff",p.fillText(t.name,w,v),p.font="normal bold "+.032*m*2+"px myFirstFont",p.fillStyle="#333",p.fillText(a+"."+l,w,I),p.fillText(o,w,S)}else if(3==h&&1==x){p.drawImage(b,.74*m*2,1119/1334*d*2,14/75*m*2,14/75*m*2),p.font="normal bold "+100/750*m*2+"px myFirstFont",p.fillStyle="#b8742b";var k=Math.floor(.1917*s*2),O=Math.floor(.5803*s*2),P=Math.floor(.113*s*2),D=Math.floor(.608*d*2),j=Math.floor(.8785*d*2),A=Math.floor(.9085*d*2),E=Math.floor(.9385*d*2);p.fillText(t.starttime,k,D),p.fillText(t.endtime,O,D),p.font="normal bold "+.048*m*2+"px myFirstFont",p.fillStyle="#333",p.fillText(t.name,P,j),p.font="normal bold "+.032*m*2+"px myFirstFont",p.fillText(a+"."+l,P,A),p.fillText(o,P,E)}else if(3==h&&2==x){p.drawImage(b,.408*m*2,786/1334*d*2,14/75*m*2,14/75*m*2),p.font="normal bold "+.064*m*2+"px myFirstFont",p.fillStyle="#fff";var N=Math.floor(.246*s*2),U=Math.floor(.5667*s*2),B=Math.floor(.113*s*2),C=Math.floor(.463*d*2),J=Math.floor(.8785*d*2),L=Math.floor(.9085*d*2),R=Math.floor(.9385*d*2);p.fillText(t.starttime1,N,C),p.fillText(t.endtime1,U,C),p.font="normal bold "+.048*m*2+"px myFirstFont",p.fillText(t.name,B,J),p.font="normal bold "+.032*m*2+"px myFirstFont",p.fillText(a+"."+l,B,L),p.fillText(o,B,R)}else if(4==h&&1==x){p.drawImage(b,.408*m*2,1079/1334*d*2,14/75*m*2,14/75*m*2),p.font="normal bold "+.064*m*2+"px myFirstFont",p.fillStyle="#000";var z=Math.floor(.347*s*2),_=Math.floor(.58*d*2);p.fillText(t.discount,z,_)}else if(4==h&&2==x){p.drawImage(b,.408*m*2,1090/1334*d*2,14/75*m*2,14/75*m*2),p.font="normal bold "+100/750*m*2+"px myFirstFont",p.fillStyle="#f02964";var W=Math.floor(.246*s*2),Y=Math.floor(.236*s*2),q=Math.floor(.5373*s*2),G=Math.floor(.422*d*2),V=Math.floor(.6808*d*2);p.fillText(t.discount,W,G),p.font="normal bold "+.048*m*2+"px myFirstFont",p.fillStyle="#333",p.fillText(t.starttime2,Y,V),p.fillText(t.endtime2,q,V)}else if(5==h&&1==x){p.drawImage(b,550/750*m*2,1110/1334*d*2,14/75*m*2,14/75*m*2),p.font="normal bold "+100/750*m*2+"px myFirstFont",p.fillStyle="#000";var H=Math.floor(.1426*s*2),K=Math.floor(.6013*s*2),Q=Math.floor(.31*s*2),X=Math.floor(.1333*s*2),Z=Math.floor(.4764*d*2),tt=Math.floor(.7869*d*2),et=(Math.floor(.7669*d*2),Math.floor(.89*d*2)),ot=Math.floor(.92*d*2),at=Math.floor(.95*d*2);p.fillText(t.starttime3,H,Z),p.fillText(t.endtime3,K,Z),p.font="normal bold "+.048*m*2+"px myFirstFont",p.fillStyle="#fb5b64",p.fillText(t.business,Q,tt),p.fillStyle="#333",p.fillText(t.name,X,et),p.font="normal bold "+.032*m*2+"px myFirstFont",p.fillText(a+"."+l,X,ot),p.fillText(o,X,at)}else if(5==h&&2==x){p.drawImage(b,551/750*m*2,1111/1334*d*2,14/75*m*2,14/75*m*2),p.font="normal bold "+.04*m*2+"px myFirstFont",p.fillStyle="#f6c33b";var lt=Math.floor(.298*s*2),it=Math.floor(.415*s*2),nt=Math.floor(.1333*s*2),ft=Math.floor(.801*d*2),rt=Math.floor(.89*d*2),st=Math.floor(.92*d*2),mt=Math.floor(.95*d*2);p.fillText(t.businessMonth,lt,ft),p.fillText(t.businessDate,it,ft),p.fillStyle="#333",p.fillText(t.name,nt,rt),p.font="normal bold "+.032*m*2+"px myFirstFont",p.fillText(a+"."+l,nt,st),p.fillText(o,nt,mt)}}}function f(){t.showcanvas=!1;var e=document.getElementById("main"),o=e.toDataURL("image/jpeg",.7);t.canvasImg=o,t.btnText="长按保存至手机，再发到朋友圈炫耀"}var r=JSON.parse(sessionStorage.getItem("user"));t.fastuse=!0,t.user=r,t.btnText="一键生成海报",t.loading=!1,t.showcanvas=!0,t.showmodel=!1,t.canvasImg="",t.name="请添加",t.zhekou="八",t.lijian="000",t.starttime="08",t.endtime="24",t.starttime1="08:00",t.endtime1="24:00",t.starttime2="2017.05.01",t.endtime2="2017.05.05",t.starttime3="01",t.endtime3="05",t.discount="00",t.business="06",t.businessMonth="05",t.businessDate="01";var s=document.documentElement.clientWidth,m=Math.floor(s),d=Math.floor(1.83*s);$("#main").css("width",m+"px"),$("#main").css("height",d+"px"),console.log(t.user);var h=i.type,x=i.num;t.page=1,t.showImg="../../assets/images/notice/type"+h+"/img_"+x+".png",t.editInformation=function(t){t.stopPropagation(),a.path("editInformation")},t.useTemplatePage=function(e){e.stopPropagation(),f(),t.showmodel=!0,t.btnText="长按保存至手机，再发到朋友圈炫耀"},t.goBack=function(t){t.stopPropagation(),o.history.back()},t.chengeText=function(){t.fastuse=!0,t.name="",t.zhekou="",t.lijian="",t.starttime="",t.endtime="",t.starttime1="",t.endtime1="",t.starttime2="",t.endtime2="",t.starttime3="",t.endtime3="",t.discount="",t.business="",t.businessMonth="",t.businessDate="",t.showmodel||(1==h?$(".name-input-fixed").show():2==h&&1==x?$(".name-input-fixed-1").show():2==h&&2==x?$(".name-input-fixed-2").show():3==h&&1==x?$(".name-input-fixed-3").show():3==h&&2==x?$(".name-input-fixed-4").show():4==h&&1==x?$(".name-input-fixed-5").show():4==h&&2==x?$(".name-input-fixed-6").show():5==h&&1==x?$(".name-input-fixed-7").show():5==h&&2==x&&$(".name-input-fixed-8").show())},t.updateText=function(){n(),1==h?$(".name-input-fixed").fadeOut(50):2==h&&1==x?$(".name-input-fixed-1").fadeOut(50):2==h&&2==x?$(".name-input-fixed-2").fadeOut(50):3==h&&1==x?$(".name-input-fixed-3").fadeOut(50):3==h&&2==x?$(".name-input-fixed-4").fadeOut(50):4==h&&1==x?$(".name-input-fixed-5").fadeOut(50):4==h&&2==x?$(".name-input-fixed-6").fadeOut(50):5==h&&1==x?$(".name-input-fixed-7").fadeOut(50):5==h&&2==x&&$(".name-input-fixed-8").fadeOut(50),t.fastuse=!1},t.closeText=function(e){e.stopPropagation(),t.user.iscomplete=!0},t.changeImg=function(e){e.stopPropagation(),t.loading=!0,t.showmodel=!1,t.page>=2?(t.page=1,t.showImg="../../assets/images/notice/type"+x+"/img_"+t.page+".png",t.loading=!1):(t.page+=1,t.showImg="../../assets/images/notice/type"+x+"/img_"+t.page+".png",t.loading=!1),n()};var u=document.getElementById("main"),p=u.getContext("2d");u.width=2*m,u.height=2*d,$(function(){n()});var c=$(".hideImg").qrcode({width:200,height:200,correctLevel:0,text:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+t.user.uuid}).hide(),g=c.find("canvas").get(0),M=g.toDataURL("image/jpg"),b=new Image;b.src=M}]);
index.controller("useGreetCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(t,e,o,a,n,i){function s(){t.btnText="一键生成海报",t.showcanvas=!0;var e=new Image;e.src=t.showImg,e.onload=function(){if(u.drawImage(e,0,0,2*c,2*m),1==d&&1==h){u.font="normal bold "+.096*c*2+"px myFirstFont",u.fillStyle="#fff";var o=Math.floor(.066*f*2),a=Math.floor(.1466*f*2),n=Math.floor(.145*m*2),i=Math.floor(.349*m*2);u.fillText(t.title,o,n),u.font="normal bold "+.04*c*2+"px myFirstFont",u.fillStyle="#0f0f0b",u.fillText(t.desc,a,i)}else if(1==d&&2==h){u.font="normal bold "+.04*c*2+"px myFirstFont",u.fillStyle="#fff";var s=Math.floor(.586*f*2),l=Math.floor(.731*m*2),r=Math.floor(.6848*m*2),g=Math.floor(.638*m*2);u.fillText(t.desc3,s,l),u.fillText(t.desc2,s,r),u.fillText(t.desc1,s,g)}else 3==d&&1==h?u.drawImage(v,.096*c*2,1099/1334*m*2,14/75*c*2,14/75*c*2):3==d&&2==h&&u.drawImage(v,.408*c*2,1099/1334*m*2,14/75*c*2,14/75*c*2)}}function l(){t.showcanvas=!1;var e=document.getElementById("main"),o=e.toDataURL("image/jpeg",.7);t.canvasImg=o,t.btnText="长按保存至手机，再发到朋友圈炫耀"}var r=JSON.parse(sessionStorage.getItem("user"));t.user=r,t.btnText="一键生成海报",t.loading=!1,t.showcanvas=!0,t.showmodel=!1,t.canvasImg="",t.title="点击添加标题",t.desc="点击添加海报描述",t.desc1="点击添加海报描述",t.desc2="点击添加海报描述",t.desc3="点击添加海报描述";var f=document.documentElement.clientWidth,c=Math.floor(f),m=Math.floor(1.83*f);$("#main").css("width",c+"px"),$("#main").css("height",m+"px"),console.log(t.user);var d=i.type,h=i.num;t.page=1,t.showImg="../../assets/images/greet/type"+d+"/img_"+h+".png",t.editInformation=function(t){t.stopPropagation(),a.path("editInformation")},t.useTemplatePage=function(e){e.stopPropagation(),l(),t.showmodel=!0,t.btnText="长按保存至手机，再发到朋友圈炫耀"},t.goBack=function(t){t.stopPropagation(),o.history.back()},t.chengeText=function(){t.showmodel||(1==d&&1==h?$(".name-input-fixed-1").show():1==d&&2==h&&$(".name-input-fixed-2").show())},t.updateText=function(){s(),1==d&&1==h?$(".name-input-fixed-1").fadeOut(50):1==d&&2==h&&$(".name-input-fixed-2").fadeOut(50)},t.closeText=function(e){e.stopPropagation(),t.user.iscomplete=!0};var g=document.getElementById("main"),u=g.getContext("2d");g.width=2*c,g.height=2*m,$(function(){s()});var p=$(".hideImg").qrcode({width:200,height:200,correctLevel:0,text:"http://syrapi.yueyishujia.com/yueAssistant/build/html/homePage/"+t.user.uuid}).hide(),x=p.find("canvas").get(0),w=x.toDataURL("image/jpg"),v=new Image;v.src=w}]);
index.controller("vipCenterCtrl",["$scope","$http","$window","$location","$rootScope",function(e,i,t,n,o){i.post("/user/vippage.json",postCfg).then(function(i){if(console.log(i),1===i.data.code){for(var t=i.data.data.viplist,n=0;n<t.length;n++)t[n].selected=!1;e.vipList=i.data.data.viplist}},function(e){}),e.vipid="",e.selectVip=function(i){if(i.selected===!0)i.selected=!1,e.vipid="";else{for(var t=0;t<e.vipList.length;t++)e.vipList[t].selected=!1;i.selected=!0,e.vipid=i.id}},e.showMenu=function(){$(".up-muenu").show()},e.hideMenu=function(){$(".up-muenu").hide()},e.buyVip=function(){return""===e.vipid?(alert("请选择要购买的会员选项"),!1):void i.post("/user/buyvip.json",{vipid:e.vipid},postCfg).success(function(e){if(console.log(e),1===e.code){var t={type:"wz",orderid:e.data.id};i.post("/pay/prepay.json",t,postCfg).success(function(e){if(console.log(e),1===e.code){var i=e.data;WeixinJSBridge&&WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:i.appId,timeStamp:i.timeStamp.toString(),nonceStr:i.nonceStr,"package":i["package"],signType:i.signType,paySign:i.paySign},function(e){"get_brand_wcpay_request:ok"==e.err_msg?window.location.href="/yueAssistant/build/html/paySuccess":alert("支付失败,请稍后再试！")})}else 0===e.code}).error(function(e){})}else 0===resp.code}).error(function(e){})}}]);
index.controller("wechatCircleCtrl",["$scope","$http","$window","$location","$rootScope","$routeParams",function(e,o,t,n,i,s){var a=JSON.parse(sessionStorage.getItem("user"));e.user=a,e.btnText="立即使用",e.loading=!1,console.log(e.user);var r=s.type,c=s.num;e.page=1,e.showImg="../../assets/images/promotion/type"+r+"/img_"+c+".png",e.editInformation=function(){n.path("editInformation")},e.useTemplatePage=function(){e.btnText="长按保存至手机，再发到朋友圈炫耀"},e.goBack=function(){t.history.back()},e.closeText=function(){e.user.iscomplete=!0}}]);
index.controller("workHoursCtrl",["$scope","$http","$window","$location","$rootScope","$timeout",function(t,a,e,i,o,n){var r=new lCalendar;r.init({trigger:".starttime",type:"time"});var s=new lCalendar;s.init({trigger:".endtime",type:"time"});var d=[{name:"星期一",iswork:"0"},{name:"星期二",iswork:"0"},{name:"星期三",iswork:"0"},{name:"星期四",iswork:"0"},{name:"星期五",iswork:"0"},{name:"星期六",iswork:"0"},{name:"星期日",iswork:"0"}];a.post("/user/worktime.json",postCfg).then(function(a){if(-1===a.data.code)t.isLogin=!1,i.path("fast_login");else if(1===a.data.code){t.isLogin=!0,""===a.data.data.starttime||"未知"===a.data.data.starttime?t.starttime="8:00":t.starttime=a.data.data.starttime,""===a.data.data.endtime||"未知"===a.data.data.endtime?t.endtime="22:00":t.endtime=a.data.data.endtime;for(var e=a.data.data.workday,o=0;o<e.length;o++)d[o].iswork=e[o],t.workdayList=d}},function(t){}),t.selectWeek=function(t){1==t.iswork?t.iswork=0:t.iswork=1},t.saveInformation=function(){for(var o="",r=0;r<t.workdayList.length;r++)o+=t.workdayList[r].iswork;var s={workday:o,starttime:t.starttime,endtime:t.endtime};console.log(s),a.post("/user/edit.json",s,postCfg).then(function(t){-1===t.data.code?i.path("fast_login"):1===t.data.code&&n(function(){e.history.back()})},function(t){})}}]);
index.controller("worksCtrl",["$scope","$http","$window","$location","$rootScope","$timeout",function(o,e,t,n,a,r){function s(){e.post("/user/workslist.json",postCfg).then(function(e){if(console.log(e),1===e.data.code){for(var t=e.data.data.allworks,n=0;n<t.length;n++)t[n].imgurl=picBasePath+t[n].imgurl;o.allworks=[],o.allworks=t;for(var a=e.data.data.recommendworks,r=0;r<a.length;r++)a[r].imgurl=picBasePath+a[r].imgurl;o.recommendworks=[],o.recommendworks=a}},function(o){})}function d(){return 0===o.localId.length?(alert("请选择图片!"),!1):void wx.uploadImage({localId:o.localId[o.upImg],isShowProgressTips:1,success:function(t){o.serverId=[],o.serverId.push(t.serverId);var n={worksmediaid:o.serverId};e.post("/user/uploadworks.json",n,postCfg).then(function(e){1===e.data.code&&(s(),o.upImg<o.localId.length&&(o.upImg+=1,d()))},function(o){})},fail:function(o){}})}o.deleteImg=!1,o.upImg=0,s(),o.deleteRecommendworks=function(o){var t={add:[],rm:[o.id]};e.post("/user/setrecommend.json",t,postCfg).then(function(o){1===o.data.code&&s()},function(o){})},o.addAllworks=function(t){if(o.recommendworks.length>=6)return alert("最多只能设置6张图片作为主页作品展示！"),!1;var n={add:[t.id],rm:[]};e.post("/user/setrecommend.json",n,postCfg).then(function(o){console.log(o),1===o.data.code&&s()},function(o){})},o.deleteAllworks=function(o,t){if(o.stopPropagation(),1==t.recommend)return void alert("该作品已在主页展示,请先移除主页作品后再删除照片!");var n={worksid:[t.id]};e.post("/user/deleteworks.json",n,postCfg).then(function(o){1===o.data.code&&s()},function(o){})},o.showDeleteBtn=function(){o.deleteImg=!o.deleteImg},o.showPrompt=function(){alert("请从下方全部作品中选择！")},o.saveWorkImg=function(){r(function(){t.history.back()})};var c={url:t.location.href.split("#")[0]};e.post("/user/unl/wzinfo.json",c,postCfg).then(function(o){1===o.data.code&&wx.config({debug:!1,appId:o.data.data.appid,timestamp:o.data.data.timestamp,nonceStr:o.data.data.noncestr,signature:o.data.data.signature,jsApiList:["chooseImage","uploadImage"]})},function(o){}),o.updateWorkImg=function(){wx.chooseImage({count:6,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){return o.localId=e.localIds,0===o.localId.length?(alert("请选择图片!"),!1):(o.upImg=0,void d())}})}}]);